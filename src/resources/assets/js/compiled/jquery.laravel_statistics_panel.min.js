Function.prototype.inheritsFrom=function(t){return t.constructor==Function?(this.prototype=new t,this.prototype.constructor=this,this.prototype.parent=t.prototype):(this.prototype=t,this.prototype.constructor=this,this.prototype.parent=t),this},window.statistics_panel={},window.statistics_panel.config=function(){var t=[{color_name:"light-blue",color:"#3c8dbc",highlight:"#3c8dbc"},{color_name:"gray",color:"#d2d6de",highlight:"#d2d6de"},{color_name:"green",color:"#00a65a",highlight:"#00a65a"},{color_name:"yellow",color:"#f39c12",highlight:"#f39c12"},{color_name:"red",color:"#f56954",highlight:"#f56954"},{color_name:"aqua",color:"#00c0ef",highlight:"#00c0ef"},{color_name:"navy",color:"#001F3F",highlight:"#001F3F"},{color_name:"teal",color:"#39CCCC",highlight:"#39CCCC"},{color_name:"purple",color:"#605ca8",highlight:"#605ca8"},{color_name:"orange",color:"#ff851b",highlight:"#ff851b"},{color_name:"maroon",color:"#D81B60",highlight:"#D81B60"},{color_name:"black",color:"#111111",highlight:"#111111"}],o={pie:{options:{segmentShowStroke:!0,segmentStrokeColor:"#fff",segmentStrokeWidth:1,percentageInnerCutout:50,animationSteps:100,animationEasing:"easeOutBounce",animateRotate:!0,animateScale:!1,responsive:!0,maintainAspectRatio:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<segments.length; i++){%><li><span style="background-color:<%=segments[i].fillColor%>"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>',tooltipTemplate:"<%=value %>",datasetFill:!1},colors:[{color:widgetColorPalette[0].color,highlight:widgetColorPalette[0].color,color_name:widgetColorPalette[0].color_name},{color:widgetColorPalette[1].color,highlight:widgetColorPalette[1].color,color_name:widgetColorPalette[1].color_name},{color:widgetColorPalette[2].color,highlight:widgetColorPalette[2].color,color_name:widgetColorPalette[2].color_name},{color:widgetColorPalette[3].color,highlight:widgetColorPalette[3].color,color_name:widgetColorPalette[3].color_name},{color:widgetColorPalette[4].color,highlight:widgetColorPalette[4].color,color_name:widgetColorPalette[4].color_name},{color:widgetColorPalette[5].color,highlight:widgetColorPalette[5].color,color_name:widgetColorPalette[5].color_name},{color:widgetColorPalette[6].color,highlight:widgetColorPalette[6].color,color_name:widgetColorPalette[6].color_name},{color:widgetColorPalette[7].color,highlight:widgetColorPalette[7].color,color_name:widgetColorPalette[7].color_name},{color:widgetColorPalette[8].color,highlight:widgetColorPalette[8].color,color_name:widgetColorPalette[8].color_name},{color:widgetColorPalette[9].color,highlight:widgetColorPalette[9].color,color_name:widgetColorPalette[9].color_name},{color:widgetColorPalette[10].color,highlight:widgetColorPalette[10].color,color_name:widgetColorPalette[10].color_name},{color:widgetColorPalette[11].color,highlight:widgetColorPalette[11].color,color_name:widgetColorPalette[11].color_name}]},bar:{options:{scaleBeginAtZero:!0,scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,barShowStroke:!0,barStrokeWidth:2,barValueSpacing:5,barDatasetSpacing:1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].fillColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',multiTooltipTemplate:"<%= datasetLabel %> - <%= value %>",responsive:!0,maintainAspectRatio:!0,datasetFill:!1},colors:[{fillColor:widgetColorPalette[0].color,strokeColor:widgetColorPalette[0].color,pointColor:widgetColorPalette[0].color},{fillColor:widgetColorPalette[1].color,strokeColor:widgetColorPalette[1].color,pointColor:widgetColorPalette[1].color},{fillColor:widgetColorPalette[2].color,strokeColor:widgetColorPalette[2].color,pointColor:widgetColorPalette[2].color},{fillColor:widgetColorPalette[3].color,strokeColor:widgetColorPalette[3].color,pointColor:widgetColorPalette[3].color},{fillColor:widgetColorPalette[4].color,strokeColor:widgetColorPalette[4].color,pointColor:widgetColorPalette[4].color},{fillColor:widgetColorPalette[5].color,strokeColor:widgetColorPalette[5].color,pointColor:widgetColorPalette[5].color},{fillColor:widgetColorPalette[6].color,strokeColor:widgetColorPalette[6].color,pointColor:widgetColorPalette[6].color},{fillColor:widgetColorPalette[7].color,strokeColor:widgetColorPalette[7].color,pointColor:widgetColorPalette[7].color},{fillColor:widgetColorPalette[8].color,strokeColor:widgetColorPalette[8].color,pointColor:widgetColorPalette[8].color},{fillColor:widgetColorPalette[9].color,strokeColor:widgetColorPalette[9].color,pointColor:widgetColorPalette[9].color},{fillColor:widgetColorPalette[10].color,strokeColor:widgetColorPalette[10].color,pointColor:widgetColorPalette[10].color},{fillColor:widgetColorPalette[11].color,strokeColor:widgetColorPalette[11].color,pointColor:widgetColorPalette[11].color}]},toplist:{colors:[{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name},{color_name:widgetColorPalette[3].color_name}]},line:{options:{scaleShowGridLines:!0,scaleGridLineColor:"rgba(0,0,0,.05)",scaleGridLineWidth:1,scaleShowHorizontalLines:!0,scaleShowVerticalLines:!0,bezierCurve:!0,bezierCurveTension:.4,pointDot:!0,pointDotRadius:4,pointDotStrokeWidth:1,pointHitDetectionRadius:20,datasetStroke:!0,datasetStrokeWidth:2,datasetFill:!1,legendTemplate:'<ul class="<%=name.toLowerCase()%>-legend"><% for (var i=0; i<datasets.length; i++){%><li><span style="background-color:<%=datasets[i].strokeColor%>"></span><%if(datasets[i].label){%><%=datasets[i].label%><%}%></li><%}%></ul>',multiTooltipTemplate:"<%= datasetLabel %> - <%= value %>",tooltipTemplate:"<%= value %>",tooltipCaretSize:0},colors:[{fillColor:widgetColorPalette[0].color,strokeColor:widgetColorPalette[0].color,pointColor:widgetColorPalette[0].color,pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:widgetColorPalette[0].color},{fillColor:widgetColorPalette[1].color,strokeColor:widgetColorPalette[1].color,pointColor:widgetColorPalette[1].color,pointStrokeColor:"#fff",pointHighlightFill:"#fff",pointHighlightStroke:widgetColorPalette[1].color}]}};return{color_palette:t,chart_options:o}}(),window.statistics_panel.widgets=function(){function t(t,o,e){"use strict";this.id=t}function o(o,e,i){t.apply(this,Array.prototype.slice.call(arguments)),this.chart=null,this.options=i,this.colors=e}function e(o){t.apply(this,Array.prototype.slice.call(arguments))}function i(){t.apply(this,Array.prototype.slice.call(arguments))}function l(t,e,i){o.apply(this,Array.prototype.slice.call(arguments))}function r(t){i.apply(this,Array.prototype.slice.call(arguments))}function a(t,e,i){o.apply(this,Array.prototype.slice.call(arguments))}function s(o,e){t.apply(this,Array.prototype.slice.call(arguments)),this.colors=e}function n(t,o){e.apply(this,Array.prototype.slice.call(arguments)),this.markerClusterer=null;var i=($.extend({},{},o||{}),[{featureType:"landscape",stylers:[{saturation:-100},{lightness:65},{visibility:"on"}]},{featureType:"poi",stylers:[{saturation:-100},{lightness:51},{visibility:"simplified"}]},{featureType:"road.highway",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"road.arterial",stylers:[{saturation:-100},{lightness:30},{visibility:"on"}]},{featureType:"road.local",stylers:[{saturation:-100},{lightness:40},{visibility:"on"}]},{featureType:"transit",stylers:[{saturation:-100},{visibility:"simplified"}]},{featureType:"administrative.province",stylers:[{visibility:"off"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{lightness:-25},{saturation:-100}]},{featureType:"water",elementType:"geometry",stylers:[{hue:"#ffff00"},{lightness:-25},{saturation:-97}]}]),l={zoom:6,center:new google.maps.LatLng(47.5011151657,19.0531965145),mapTypeId:google.maps.MapTypeId.ROADMAP,styles:i};this.map=new google.maps.Map($(".map",this.id)[0],l)}function c(t,e,i){o.apply(this,Array.prototype.slice.call(arguments))}return t.prototype.setTitle=function(t){this.getTitle().html(t)},t.prototype.getTitle=function(){return $(".title",this.id)},t.prototype.getFooter=function(){return $(".footer",this.id)},t.prototype.getLoadIcon=function(){return $(".overlay",this.id)},t.prototype.setLoadIcon=function(t){t?this.getLoadIcon().removeClass("hide"):this.getLoadIcon().addClass("hide")},t.prototype.getType=function(){return $(this.id).data("type")},t.prototype.setFooter=function(t){this.getFooter().html(t)},o.prototype=new t,o.prototype.getDiagram=function(){return $(".diagram",this.id)},o.prototype.getChart=function(){return this.chart},o.prototype.setOptions=function(t){this.options=t},o.prototype.getOptions=function(){return this.options},o.prototype.setColors=function(t){this.colors=t},e.prototype=new t,e.prototype.getGridBody=function(){return $(".box-body",this.id)},e.prototype.setGrid=function(t){var o,e,i,l,r,a,s,n,c="";if(c+='<div class="row">',t.datasets)for(o=0,e=t.datasets.length;e>o;o+=1){for(c+='<div class="col-md-'+12/t.datasets.length+'"><table class="table no-margin table-striped table-hover table-bordered">',c+="<thead><tr>",i=0,l=t.labels.length;l>i;i+=1)c+="<th>"+t.labels[i]+"</th>";for(c+="</tr></thead>",c+="<tbody>",r=0,a=t.datasets[o].length;a>r;r+=1){for(c+="<tr>",s=0,n=l;n>s;s+=1)c+="<td>"+t.datasets[o][r][s]+"</td>";c+="</tr>"}c+="</tbody>",c+="</table></div>"}else c+='<div class="col-md-12 text-center margin">No data to display</div>';c+="</div>",this.getGridBody().html(c)},i.prototype=new t,i.prototype.getValue=function(){return $(".value",this.id)},i.prototype.setValue=function(t){this.getValue().html(t)},l.prototype=new o,l.prototype.getLegend=function(){return $(".chart-legend",this.id)},l.prototype.setLegend=function(t){var o,e,i="";for(o=0,e=t.length;e>o;o+=1)i+='<li><i class="fa fa-circle-o text-'+this.colors[o].color_name+'"></i> '+t[o].label+"</li>";return i},l.prototype.colorize=function(t){var o,e;if(t)for(o=0,e=t.length;e>o;o+=1)t[o].color=this.colors[o].color,t[o].highlight=this.colors[o].highlight;return t},l.prototype.setDiagram=function(t){if(null!==this.chart&&this.chart.destroy(),t&&0!==t.length){$(".chart-item",this.id).removeClass("hidden"),$(".no-data",this.id).addClass("hidden");var o=new Chart(this.getDiagram()[0].getContext("2d"));this.chart=o.Doughnut(this.colorize(t),this.getOptions()),this.getLegend().html(this.setLegend(t))}else $(".chart-item",this.id).addClass("hidden"),$(".no-data",this.id).removeClass("hidden")},r.prototype=new i,r.prototype.setDescription=function(t){$(".progress-description",this.id).text(t)},r.prototype.setPercent=function(t){$(".progress-bar",this.id).css("width",t+"%")},a.prototype=new o,a.prototype.setDiagram=function(t){if(null!==this.chart&&this.chart.destroy(),t&&0!==t.length){$(".chart-item",this.id).removeClass("hidden"),$(".no-data",this.id).addClass("hidden");var o=new Chart(this.getDiagram()[0].getContext("2d"));this.chart=o.Line(this.colorize(t),this.getOptions())}else $(".chart-item",this.id).addClass("hidden"),$(".no-data",this.id).removeClass("hidden")},a.prototype.colorize=function(t){var o,e;for(o=0,e=t.datasets.length;e>o;o+=1)t.datasets[o].fillColor=this.colors[o].fillColor,t.datasets[o].strokeColor=this.colors[o].strokeColor,t.datasets[o].pointColor=this.colors[o].pointColor,t.datasets[o].pointStrokeColor=this.colors[o].pointStrokeColor,t.datasets[o].pointHighlightFill=this.colors[o].pointHighlightFill,t.datasets[o].pointHighlightStroke=this.colors[o].pointHighlightStroke;return t},s.prototype=new t,s.prototype.getGridBody=function(){return $(".box-body",this.id)},s.prototype.setGrid=function(t){var o,e,i,l,r="";if(r+='<div class="row">',t.datasets)for(o=0,e=t.datasets.length;e>o;o+=1){for(r+='<div class="col-md-'+12/t.datasets.length+'"><div class="progress-group">',i=0,l=t.datasets[o].length;l>i;i+=1)r+='<span class="progress-text">'+t.datasets[o][i][0]+'</span><span class="progress-number"><b>'+t.datasets[o][i][1]+'</b></span><div class="progress sm"><div class="progress-bar bg-'+this.colors[i].color_name+'" style="width: '+100*(t.datasets[o][i][1]/t.datasets[o][0][1])+'%"></div></div>';r+="</div></div>"}else r+='<div class="col-md-12 text-center margin">No data to display</div>';r+="</div>",this.getGridBody().html(r)},n.prototype=new e,n.prototype.getGridBody=function(){return $(".toplist",this.id)},n.prototype.setMultiMap=function(t){var o,e,i=[];if(this.markerClusterer&&this.markerClusterer.clearMarkers(),t.map){for(o=0,e=t.map.length;e>o;o+=1){var l=new google.maps.LatLng(t.map[o].lat,t.map[o].lng),r=new google.maps.Marker({position:l,title:t.map[o].name+": "+t.map[o].value});i.push(r)}this.markerClusterer=new MarkerClusterer(this.map,mar,{imagePath:"/images/vendor/js-marker-clusterer/m"}),this.markerClusterer.setCalculator(function(t,o){for(var e,i=0,l=0,r=0,a=t.length;a>r;r++)i+=Number(t[r].getTitle().match(/(\d+)$/g)[0]);for(e=i;0!==e;)e=parseInt(e/10,10),l++;return l=Math.min(l,o),{text:i,index:l}})}t.toplist&&this.setGrid(t.toplist)},c.prototype=new o,c.prototype.setDiagram=function(t){null!==this.chart&&this.chart.destroy();var o=new Chart(this.getDiagram()[0].getContext("2d"));this.chart=o.Bar(this.colorize(t),this.getOptions())},c.prototype.colorize=function(t){var o,e;for(o=0,e=t.datasets.length;e>o;o+=1)t.datasets[o].fillColor=this.colors[o].fillColor,t.datasets[o].strokeColor=this.colors[o].strokeColor,t.datasets[o].pointColor=this.colors[o].pointColor;return t},{Widget:t,ChartWidget:o,GridWidget:e,BoxWidget:i,DoughnutChartWidget:l,GoalCompletionWidget:r,LineChartWidget:a,ToplistWidget:s,MapToplistWidget:n,BarChartWidget:c}}(),window.statistics_panel.stat_widgets=function(){function t(t){this.id=t,window.statistics_panel.widgets.GoalCompletionWidget.apply(this,Array.prototype.slice.call(arguments))}function o(t){this.id=t,window.statistics_panel.widgets.ToplistWidget.apply(this,[t,window.statistics_panel.config.chart_options.toplist.colors])}function e(t){this.id=t,window.statistics_panel.widgets.GridWidget.apply(this,[t])}function i(t){this.id=t,window.statistics_panel.widgets.DoughnutChartWidget.apply(this,[t,window.statistics_panel.config.chart_options.pie.colors,window.statistics_panel.config.chart_options.pie.options])}function l(t){this.id=t,window.statistics_panel.widgets.ToplistWidget.apply(this,[t,window.statistics_panel.config.chart_options.toplist.colors])}return t.prototype=new window.statistics_panel.widgets.GoalCompletionWidget,t.prototype.init=function(){},t.prototype.update=function(t){this.setPercent(t.percent),this.setDescription(t.description),this.setValue(t.reached)},o.prototype=new window.statistics_panel.widgets.ToplistWidget,o.prototype.init=function(){},o.prototype.update=function(t){this.setGrid(t)},e.prototype=new window.statistics_panel.widgets.GridWidget,e.prototype.init=function(){},e.prototype.update=function(t){this.setGrid(t)},i.prototype=new window.statistics_panel.widgets.DoughnutChartWidget,i.prototype.init=function(){},i.prototype.update=function(t){this.setDiagram(t)},l.prototype=new window.statistics_panel.widgets.MapToplistWidget,l.prototype.init=function(){},l.prototype.update=function(t){this.setMultiMap(t)},{StatGoalCompletionWidget:t,StatToplistWidget:o,StatGridWidget:e,StatDoughnutChartWidget:i,StatMapToplistWidget:l}}(),window.statistics_panel.boxes=function(){function t(t,o){this.context=t,this.source=o}function o(o,e){this.context=o,this.source=e,t.apply(this,Array.prototype.slice.call(arguments))}function e(o,e){t.apply(this,Array.prototype.slice.call(arguments))}function i(t,o){e.apply(this,Array.prototype.slice.call(arguments))}return t.prototype.init=function(){var t=this;$(".stat-widget",this.context).each(function(o,e){t.setWidget($(e))}),this.boot()},t.prototype.boot=function(){this.fetchDatas()},t.prototype.setLoadIcons=function(t){$(".stat-widget",this.context).each(function(o,e){$(e).data("widget").setLoadIcon(t)})},t.prototype.updateWidgets=function(t){var o,e=$(".stat-widget",this.context);for(o in t){var i=e.filter('[data-stat-id="'+o+'"]');i.length>0&&(i.data("widget").update(t[o]),i.data("widget").setLoadIcon(!1))}},t.prototype.setWidget=function(t){var o=(t.data("statId"),new(window.statistics_panel.stat_widgets[t.data("type")])(t));o.init(t),t.data("widget",o)},t.prototype.fetchDatas=function(){var t=this;this.setLoadIcons(!0),$.ajax({type:"GET",url:t.source}).done(function(o){t.updateWidgets(o)})},o.inheritsFrom(t),o.prototype.boot=function(){this.fetchDatas()},o.prototype.fetchDatas=function(){var t=this;this.setLoadIcons(!0),$.ajax({type:"GET",url:t.source}).done(function(o){t.updateWidgets(o)})},e.inheritsFrom(t),e.prototype.boot=function(){var t=this;$("input.stat_interval",this.context).datepicker({format:"yyyy/mm",startView:"months",minViewMode:"months",autoclose:!0}).on("changeDate",function(){t.fetchDatas()}),this.fetchDatas()},e.prototype.fetchDatas=function(){var t,o=this,e=$("input.stat_interval.from",this.context).val().split("/");this.setLoadIcons(!0),t={"in":{year:e[0],month:e[1]}},$.ajax({type:"GET",url:this.source,data:t}).done(function(t){o.updateWidgets(t)})},i.inheritsFrom(e),i.prototype.fetchDatas=function(){var t,o=this,e=$("input.stat_interval.from",this.context).val().split("/"),i=$("input.stat_interval.to",this.context).val().split("/");this.setLoadIcons(!0),t={from:{year:e[0],month:e[1]},to:{year:i[0],month:i[1]}},$.ajax({type:"GET",url:this.source,data:t}).done(function(t){o.updateWidgets(t)})},{StatisticsBox:t,TimeIndependentBox:o,MonthlyBox:e,MonthIntervalBox:i}}();